--- 
layout: demo2 
title: Copy and Paste 
---

<style>
#drawing-mode {
  margin-bottom: 10px;
  vertical-align: top;
}
#drawing-mode-options {
  display: inline-block;
  vertical-align: top;
  margin-bottom: 10px;
  margin-top: 10px;
  background: #f5f2f0;
  padding: 10px;
}
label {
  display: inline-block; width: 130px;
}
.info {
  display: inline-block;
  width: 25px;
  background: #ffc;
}
#bd-wrapper {
  min-width: 1500px;
}
</style>

<canvas id="c" width="500" height="500" style="border:1px solid #ccc"></canvas>

<div class="controls">
	<p>
		<button id="copy">Copy Selected Objects</button>
	</p>
	<p>
		<button id="paste">Paste Selected Objects</button>
	</p>
	<p>
		<button id="group">Group Selected Objects</button>
	</p>
	<p>
		<button id="ungroup">Unroup Selected Objects</button>
	</p>
</div>

<script id="main">
	(function() {
		var canvas = new fabric.Canvas("c");
		var clipboard = null;

		var copy = document.getElementById("copy");
		var paste = document.getElementById("paste");
		var group = document.getElementById("group");
		var ungroup = document.getElementById("ungroup");

		copy.onclick = Copy;
		paste.onclick = Paste;
		group.onclick = Group;
		ungroup.onclick = Ungroup;


		function Group() {
			if (!canvas.getActiveObject()) {
				return;
			}
			if (canvas.getActiveObject().type !== 'activeSelection') {
				return;
			}
			canvas.getActiveObject().toGroup();
			canvas.requestRenderAll();
		}

		function Ungroup() {
			if (!canvas.getActiveObject()) {
				return;
			}
			if (canvas.getActiveObject().type !== 'group') {
				return;
			}
			canvas.getActiveObject().toActiveSelection();
			canvas.requestRenderAll();
		}

		function Copy() {
			var activeObject = canvas.getActiveObject();
			_clipboard = activeObject;
			console.log(_clipboard);
		}

		function Paste() {
			var activeObject = canvas.getActiveObject();
			canvas.discardActiveObject();
			if (_clipboard.size) {

				_clipboard.clone(function(clonedObj) {
					canvas.discardActiveObject();
					clonedObj.set({
						left: clonedObj.left + 10,
						top: clonedObj.top + 10,
						evented: true,
						active: true
					});

					clonedObj.forEachObject(function(obj) {
						obj.set('active', true);
						canvas.add(obj);
					});

					canvas.setActiveObject(clonedObj);
					canvas.requestRenderAll;
				});
			} else {
				_clipboard.clone(function(clonedObj) {
					canvas.discardActiveObject();
					clonedObj.set("top", _clipboard.top + 5);
					clonedObj.set("left", _clipboard.left + 5);
					clonedObj.set('active', true);
					clonedObj.setCoords();



					canvas.add(clonedObj);
					canvas.setActiveObject(clonedObj);
					canvas.requestRenderAll;
				});
			}
		}

		// create a rectangle object
		var rect = new fabric.Rect({
			left: 100,
			top: 100,
			fill: 'red',
			width: 100,
			height: 100,
			hasControls: true
		});

		canvas.add(rect);

		// create a rectangle object
		var rect2 = new fabric.Rect({
			left: 200,
			top: 250,
			fill: 'red',
			width: 100,
			height: 100,
			strokeWidth: 2,
			stroke: "#000",
			hasControls: true
		});

		canvas.add(rect2);
	})();
</script>